<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div nz-row [nzGutter]="24" *ngIf="statistic">
  <div nz-col [nzXs]="24" [nzSm]="24" [nzMd]="12" [nzLg]="12" [nzXl]="12" class="col">
    <nz-card [nzBordered]="false" nzTitle="Available Task Slots" [nzLoading]="!statistic">
      <ng-container *ngIf="statistic">
        <div class="taskslots">
          <div class="total">{{ statistic['slots-available'] | number:'1.0-0' }}</div>
          <div class="task-slot-percentage-bar"><nz-progress [nzPercent]=taskSlotPercentage></nz-progress></div>
        </div>
        <div class="footer">
          <div class="field">
            <span>Total Task Slots</span>
            <span>{{ statistic['slots-total'] | number:'1.0-0' }}</span>
          </div>
          <nz-divider nzType="vertical"></nz-divider>
          <div class="field">
            <span>Task Managers</span>
            <span>{{ statistic['taskmanagers'] | number:'1.0-0' }}</span>
          </div>
          <nz-divider nzType="vertical"></nz-divider>
          <div class="field">
            <span>CPU Cores</span>
            <span>{{ taskManagerCPUs | number:'1.0-0' }}</span>
          </div>
        </div>
      </ng-container>
    </nz-card>
  </div>
  <div nz-col [nzXs]="24" [nzSm]="24" [nzMd]="12" [nzLg]="12" [nzXl]="12" class="col">
    <nz-card [nzBordered]="false" nzTitle="Running Jobs" [nzLoading]="!statistic">
      <ng-container *ngIf="statistic">
        <div class="total">{{ statistic['jobs-running'] | number:'1.0-0' }}</div>
        <div class="footer">
          <div class="field">
            <span>Finished</span>
            <span>{{ statistic['jobs-finished'] | number:'1.0-0' }}</span>
          </div>
          <nz-divider nzType="vertical"></nz-divider>
          <div class="field">
            <span>Canceled</span>
            <span>{{ statistic['jobs-cancelled'] | number:'1.0-0' }}</span>
          </div>
          <nz-divider nzType="vertical"></nz-divider>
          <div class="field">
            <span>Failed</span>
            <span>{{ statistic['jobs-failed'] | number:'1.0-0' }}</span>
          </div>
        </div>
      </ng-container>
    </nz-card>
  </div>
  <div nz-col [nzXs]="24" [nzSm]="24" [nzMd]="24" [nzLg]="24" [nzXl]="24" class="col">
    <nz-card [nzBordered]="false" nzTitle="Task Manager Overview" [nzLoading]="!listOfTaskManager">
      <ng-container *ngFor="let manager of listOfTaskManager;">
        <i [ngClass]="{
          'task-manager-avatar-big' : listOfTaskManager.length < 20,
          'task-manager-avatar-small' : listOfTaskManager.length >= 20,
          'task-manager-avatar-green' : manager.milliSecondsSinceLastHeartBeat / 1000 < timeoutThresholdSeconds / 2,
          'task-manager-avatar-yellow' : manager.milliSecondsSinceLastHeartBeat / 1000 >= timeoutThresholdSeconds / 2 && manager.milliSecondsSinceLastHeartBeat / 1000 < timeoutThresholdSeconds,
          'task-manager-avatar-red' : manager.milliSecondsSinceLastHeartBeat / 1000 >= timeoutThresholdSeconds
          }"
           nz-icon nz-tooltip nzTheme="fill" nzType="database" [nzTitle]="managerTooltip"></i>
        <ng-template #managerTooltip>
          <span>ID: {{manager.id}}</span><br />
          <span>Free Slots: {{manager.freeSlots}}</span><br />
          <span>Total Slots: {{manager.slotsNumber}}</span><br />
          <span>CPU's :{{manager.hardware.cpuCores}}</span><br />
          <span>Physical Mem: {{manager.hardware.physicalMemory | humanizeBytes}}</span><br />
          <span>Free Mem: {{manager.hardware.freeMemory | humanizeBytes}}</span><br />
          <span>Managed Mem: {{manager.hardware.managedMemory | humanizeBytes}}</span><br />
          <span>Last Heartbeat: {{manager.milliSecondsSinceLastHeartBeat / 1000}} seconds ago</span>
        </ng-template>
      </ng-container>
    </nz-card>
  </div>
</div>
