
ğŸ“ŸAI



```yaml
containerized.master.env.KUBERNETES_MAX_CONCURRENT_REQUESTS: 200
env.java.opts.jobmanager: "-Dkubernetes.max.concurrent.requests=200"
```

### è®¿é—® Flink çš„ Web UI

å¯ä»¥é€šè¿‡ [kubernetes.rest-service.exposed.type]({{< ref "docs/deployment/config" >}}#kubernetes-rest-service-exposed-type) é…ç½®é€‰é¡¹ä»¥å¤šç§æ–¹å¼å…¬å¼€ Flink çš„ Web UI å’Œ REST ç»ˆç‚¹ã€‚

- **ClusterIP**ï¼šåœ¨é›†ç¾¤å†…éƒ¨ IP ä¸Šå…¬å¼€æœåŠ¡ã€‚æœåŠ¡åªèƒ½åœ¨é›†ç¾¤å†…è®¿é—®ã€‚å¦‚æœè¦è®¿é—® JobManager UI æˆ–å‘ç°æœ‰ä¼šè¯æäº¤ä½œä¸šï¼Œéœ€è¦å¯åŠ¨æœ¬åœ°ä»£ç†ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `localhost:8081` å‘ä¼šè¯æäº¤ Flink ä½œä¸šæˆ–æŸ¥çœ‹ä»ªè¡¨æ¿ã€‚

```bash
$ kubectl port-forward service/<ServiceName> 8081
```

- **NodePort**ï¼šåœ¨æ¯ä¸ªèŠ‚ç‚¹çš„ IP ä¸Šçš„é™æ€ç«¯å£ï¼ˆ`NodePort`ï¼‰ä¸Šå…¬å¼€æœåŠ¡ã€‚å¯ä»¥é€šè¿‡ `<NodeIP>:<NodePort>` è”ç³» JobManager æœåŠ¡ã€‚

- **LoadBalancer**ï¼šä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨å¤–éƒ¨å…¬å¼€æœåŠ¡ã€‚ç”±äºäº‘æä¾›å•†å’Œ Kubernetes éœ€è¦ä¸€äº›æ—¶é—´æ¥å‡†å¤‡è´Ÿè½½å‡è¡¡å™¨ï¼Œæ‚¨å¯èƒ½ä¼šåœ¨å®¢æˆ·ç«¯æ—¥å¿—ä¸­çœ‹åˆ°ä¸€ä¸ª `NodePort` JobManager Web ç•Œé¢ã€‚å¯ä»¥ä½¿ç”¨ `kubectl get services/<cluster-id>-rest` è·å– EXTERNAL-IPï¼Œå¹¶æ‰‹åŠ¨æ„é€ è´Ÿè½½å‡è¡¡å™¨ JobManager Web ç•Œé¢ `http://<EXTERNAL-IP>:8081`ã€‚

æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… Kubernetes çš„å®˜æ–¹æ–‡æ¡£ [åœ¨ Kubernetes ä¸­å‘å¸ƒæœåŠ¡](https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types)ã€‚

{{< hint warning >}}
æ ¹æ®æ‚¨çš„ç¯å¢ƒï¼Œä½¿ç”¨ `LoadBalancer` ç±»å‹çš„ REST æœåŠ¡å…¬å¼€çš„ Flink é›†ç¾¤å¯èƒ½ä¼šä½¿é›†ç¾¤å¯¹å¤–éƒ¨å…¬å¼€ï¼ˆé€šå¸¸å…·æœ‰æ‰§è¡Œä»»æ„ä»£ç çš„èƒ½åŠ›ï¼‰ã€‚
{{< /hint >}}

### æ—¥å¿—è®°å½•

Kubernetes é›†æˆå°† `conf/log4j-console.properties` å’Œ `conf/logback-console.xml` ä½œä¸º ConfigMap æ˜ å°„åˆ°å„ä¸ª Podã€‚å¯¹è¿™äº›æ–‡ä»¶çš„æ›´æ”¹å°†åœ¨æ–°å¯åŠ¨çš„é›†ç¾¤ä¸­å¯è§ã€‚

#### è®¿é—®æ—¥å¿—

é»˜è®¤æƒ…å†µä¸‹ï¼ŒJobManager å’Œ TaskManager å°†æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°å’Œæ¯ä¸ª Pod ä¸­çš„ `/opt/flink/log`ã€‚STDOUT å’Œ STDERR è¾“å‡ºåªä¼šé‡å®šå‘åˆ°æ§åˆ¶å°ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®å®ƒä»¬ï¼š

```bash
$ kubectl logs <pod-name>
```

å¦‚æœ Pod æ­£åœ¨è¿è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `kubectl exec -it <pod-name> bash` è¿›è¡Œéš§é“è¿æ¥å¹¶æŸ¥çœ‹æ—¥å¿—æˆ–è°ƒè¯•è¿›ç¨‹ã€‚

#### è®¿é—® TaskManager çš„æ—¥å¿—

ä¸ºäº†ä¸æµªè´¹èµ„æºï¼ŒFlink ä¼šè‡ªåŠ¨é‡Šæ”¾ç©ºé—²çš„ TaskManagersã€‚è¿™å¯èƒ½ä½¿å¾—è®¿é—®ç›¸åº” Pod çš„æ—¥å¿—å˜å¾—æ›´åŠ å›°éš¾ã€‚é€šè¿‡é…ç½® [resourcemanager.taskmanager-timeout]({{< ref "docs/deployment/config" >}}#resourcemanager-taskmanager-timeout)ï¼Œå¯ä»¥å¢åŠ é‡Šæ”¾ç©ºé—² TaskManager ä¹‹å‰çš„æ—¶é—´ï¼Œä»¥ä¾¿æœ‰æ›´å¤šæ—¶é—´æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ã€‚

#### åŠ¨æ€æ›´æ”¹æ—¥å¿—çº§åˆ«

å¦‚æœå·²é…ç½®æ—¥å¿—è®°å½•å™¨ä»¥ [è‡ªåŠ¨æ£€æµ‹é…ç½®æ›´æ”¹]({{< ref "docs/deployment/advanced/logging" >}})ï¼Œåˆ™å¯ä»¥é€šè¿‡æ›´æ”¹ç›¸åº”çš„ ConfigMapï¼ˆå‡è®¾é›†ç¾¤ ID ä¸º `my-first-flink-cluster`ï¼‰æ¥åŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼š

```bash
$ kubectl edit cm flink-config-my-first-flink-cluster
```


ğŸ®You
You are an expert linguist, specializing in translation from English to Chinese. This is an English to Chinese translation, please provide the Chinese translation for this text base on the background:\"apache flink\". Do not provide any explanations or text apart from the translation. English:### Using Plugins\\n\\nIn order to use [plugins]({{< ref \"docs/deployment/filesystems/plugins\" >}}), you must copy them to the correct location in the Flink JobManager/TaskManager pod.\\nYou can use the [built-in plugins]({{< ref \"docs/deployment/resource-providers/standalone/docker\" >}}#using-plugins) without mounting a volume or building a custom Docker image.\\nFor example, use the following command to enable the S3 plugin for your Flink session cluster.\\n\\n```bash\\n$ ./bin/kubernetes-session.sh\\n    -Dcontainerized.master.env.ENABLE_BUILT_IN_PLUGINS=flink-s3-fs-hadoop-{{< version >}}.jar \\\\n    -Dcontainerized.taskmanager.env.ENABLE_BUILT_IN_PLUGINS=flink-s3-fs-hadoop-{{< version >}}


ğŸ“ŸAI
### ä½¿ç”¨æ’ä»¶

è¦ä½¿ç”¨[æ’ä»¶]({{< ref "docs/deployment/filesystems/plugins" >}})ï¼Œå¿…é¡»å°†å®ƒä»¬å¤åˆ¶åˆ°Flink JobManager/TaskManager podçš„æ­£ç¡®ä½ç½®ã€‚æ‚¨å¯ä»¥åœ¨ä¸æŒ‚è½½å·æˆ–æ„å»ºè‡ªå®šä¹‰Dockeré•œåƒçš„æƒ…å†µä¸‹ä½¿ç”¨[å†…ç½®æ’ä»¶]({{< ref "docs/deployment/resource-providers/standalone/docker" >}}#using-plugins)ã€‚ä¾‹å¦‚ï¼Œè¦ä¸ºæ‚¨çš„Flinkä¼šè¯é›†ç¾¤å¯ç”¨S3æ’ä»¶ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
$ ./bin/kubernetes-session.sh \
    -Dcontainerized.master.env.ENABLE_BUILT_IN_PLUGINS=flink-s3-fs-hadoop-{{< version >}}.jar \ 
    -Dcontainerized.taskmanager.env.ENABLE_BUILT_IN_PLUGINS=flink-s3-fs-hadoop-{{< version >}}.jar
```

### è‡ªå®šä¹‰Dockeré•œåƒ

å¦‚æœæ‚¨æƒ³ä½¿ç”¨è‡ªå®šä¹‰Dockeré•œåƒï¼Œå¯ä»¥é€šè¿‡é…ç½®é€‰é¡¹`kubernetes.container.image.ref`æŒ‡å®šã€‚Flinkç¤¾åŒºæä¾›äº†ä¸€ä¸ªä¸°å¯Œçš„[Flink Dockeré•œåƒ]({{< ref "docs/deployment/resource-providers/standalone/docker" >}})ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚æœ‰å…³å¦‚ä½•å¯ç”¨æ’ä»¶ã€æ·»åŠ ä¾èµ–é¡¹å’Œå…¶ä»–é€‰é¡¹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[å¦‚ä½•å®šåˆ¶Flinkçš„Dockeré•œåƒ]({{< ref "docs/deployment/resource-providers/standalone/docker" >}}#customize-flink-image)ã€‚

### ä½¿ç”¨Secrets

[Kubernetes Secrets](https://kubernetes.io/docs/concepts/configuration/secret/) æ˜¯ä¸€ä¸ªåŒ…å«å°‘é‡æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å¯†ç ã€ä»¤ç‰Œæˆ–å¯†é’¥ï¼‰çš„å¯¹è±¡ã€‚è¿™äº›ä¿¡æ¯å¯èƒ½ä¼šæ”¾åœ¨podè§„èŒƒæˆ–é•œåƒä¸­ã€‚åœ¨Kubernetesä¸Šçš„Flinkå¯ä»¥ä»¥ä¸¤ç§æ–¹å¼ä½¿ç”¨Secretsï¼š

* ä»podä¸­ä½œä¸ºæ–‡ä»¶ä½¿ç”¨Secretsï¼›
  
* ä½œä¸ºç¯å¢ƒå˜é‡ä½¿ç”¨Secretsã€‚

#### ä»Podä¸­ä½œä¸ºæ–‡ä»¶ä½¿ç”¨Secrets

ä»¥ä¸‹å‘½ä»¤å°†åœ¨å¯åŠ¨çš„podä¸­å°†ç§˜å¯†`mysecret`æŒ‚è½½åˆ°è·¯å¾„`/path/to/secret`ä¸‹ï¼š

```bash
$ ./bin/kubernetes-session.sh -Dkubernetes.secrets=mysecret:/path/to/secret
```

ç„¶åï¼Œå¯ä»¥åœ¨æ–‡ä»¶`/path/to/secret/username`å’Œ`/path/to/secret/password`ä¸­æ‰¾åˆ°ç§˜å¯†`mysecret`çš„ç”¨æˆ·åå’Œå¯†ç ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[å®˜æ–¹Kubernetesæ–‡æ¡£](https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-files-from-a-pod)ã€‚

#### ä½œä¸ºç¯å¢ƒå˜é‡ä½¿ç”¨Secrets

ä»¥ä¸‹å‘½ä»¤å°†åœ¨å¯åŠ¨çš„podä¸­å°†ç§˜å¯†`mysecret`ä½œä¸ºç¯å¢ƒå˜é‡æš´éœ²ï¼š

```bash
$ ./bin/kubernetes-session.sh -Dkubernetes.env.secretKeyRef=\\
    env:SECRET_USERNAME,secret:mysecret,key:username;\\
    env:SECRET_PASSWORD,secret:mysecret,key:password
```

ç¯å¢ƒå˜é‡`SECRET_USERNAME`åŒ…å«`mysecret`ç§˜å¯†çš„ç”¨æˆ·åï¼Œè€Œç¯å¢ƒå˜é‡`SECRET_PASSWORD`åŒ…å«`mysecret`ç§˜å¯†çš„å¯†ç ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[å®˜æ–¹Kubernetesæ–‡æ¡£](https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-environment-variables)ã€‚

### åœ¨Kubernetesä¸Šçš„é«˜å¯ç”¨æ€§

ä¸ºäº†åœ¨Kubernetesä¸Šå®ç°é«˜å¯ç”¨æ€§ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[ç°æœ‰çš„é«˜å¯ç”¨æ€§æœåŠ¡]({{< ref "docs/deployment/ha/overview" >}})ã€‚

å°†<a href="{{< ref "docs/deployment/config" >}}#kubernetes-jobmanager-replicas">kubernetes.jobmanager.replicas</a>çš„å€¼è®¾ç½®ä¸ºå¤§äº1ï¼Œä»¥å¯åŠ¨å¤‡ç”¨JobManagersã€‚è¿™æœ‰åŠ©äºå®ç°æ›´å¿«çš„æ¢å¤ã€‚è¯·æ³¨æ„ï¼Œåœ¨å¯åŠ¨å¤‡ç”¨JobManagersæ—¶åº”å¯ç”¨é«˜å¯ç”¨æ€§ã€‚


